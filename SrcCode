// // App.js
import React, { useEffect, useState } from 'react';
// import Login from './components/Login';
// import HelloPage from './components/HelloPage';
import './style.css';

function App() {
  const [token, setToken] = useState(localStorage.getItem("token"));

  const handleLogin = (newToken) => {
    localStorage.setItem("token", newToken);
    setToken(newToken);
  };

  const handleLogout = () => {
    localStorage.removeItem("token");
    setToken(null);
  };

  return (
    <div>
      {token ? <HelloPage onLogout={handleLogout} /> : <Login onLogin={handleLogin} />}
    </div>
  );
}

export default App;

// components/Login.js
import React, { useState } from 'react';

const Login = ({ onLogin }) => {
  const [hasAcc, setHasAcc] = useState(true);
  const [email, setEmail] = useState('');
  const [password, setPassword] = useState('');

  const toggleRegister = () => {
    setHasAcc((prev) => !prev);
  };

  const authenticate = async () => {
    try {
      const response = await fetch(`http://localhost:5000/auth/${hasAcc ? 'login' : 'register'}`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ email, password })
      });
      const data = await response.json();
      if (data.token) {
        onLogin(data.token);
      } else {
        alert("Authentication failed");
      }
    } catch (error) {
      console.error("Error authenticating:", error);
    }
  };

  return (
    <section id="userVerification">
      <div id="sign-up">
        <h1 id="sign-up-text">{hasAcc ? 'Log In!' : 'Register!'}</h1>
        <input
          id="email-input"
          placeholder="Email"
          value={email}
          onChange={(e) => setEmail(e.target.value)}
        />
        <input
          id="password-input"
          type="password"
          placeholder="Password"
          value={password}
          onChange={(e) => setPassword(e.target.value)}
        />
        <button id="confirm-details" onClick={authenticate}>
          {hasAcc ? 'Confirm Details' : 'Create new Acc'}
        </button>
        <button id="toggle-btn" onClick={toggleRegister}>
          {hasAcc ? "I don't have an account" : 'I Have an Acc'}
        </button>
      </div>
    </section>
  );
};

export default Login;

// components/HelloPage.js
import React from 'react';

const HelloPage = ({ onLogout }) => {
  return (
    <section id="helloPage" style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', justifyContent: 'center', height: '100vh' }}>
      <h1>Hemlo</h1>
      <button id="del-token-btn" onClick={onLogout}>Delete Token</button>
    </section>
  );
};

export default HelloPage;
